<h1>Leaderboards</h1>

<% var ranks = [] %>

<% for (var i = 0; i < users.length; i++) { %>
  <% var theScore = 0 %>
  <% var theName = users[i].username %>

  <% for (var j = 0; j < scores.length; j++) { %>
    <% if (users[i].id == scores[j].user) { %>
      <% theScore = theScore + scores[j].score %>
    <% } %>
  <% } %>

  <% var info = { name: theName, score: theScore } %>
  <% ranks[i] = info %>
<% } %>

<% ranks.sort(function(a, b) { return b.score - a.score }) %>

<table>
  <thead>
    <th>Rank</th>
    <th>User</th>
    <th>Points</th>
  </thead>
  <tbody>
    <% for (var i = 0; i < ranks.length; i++) { %>
      <tr>
      	<td><%= i + 1 %></td>
        <td><%= ranks[i].name %></td>
        <td><%= ranks[i].score %> points</td>
      </tr>
    <% } %>
  </tbody>
</table>
